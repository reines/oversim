<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: I3BaseApp Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>I3BaseApp Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="I3BaseApp" -->
<p>Basic template class for <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> applications.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for I3BaseApp:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classI3BaseApp.png" usemap="#I3BaseApp_map" alt=""/>
  <map id="I3BaseApp_map" name="I3BaseApp_map">
<area href="classI3Anycast.html" alt="I3Anycast" shape="rect" coords="117,56,224,80"/>
<area href="classI3Composite.html" alt="I3Composite" shape="rect" coords="117,112,224,136"/>
<area href="classI3HostMobility.html" alt="I3HostMobility" shape="rect" coords="117,168,224,192"/>
<area href="classI3LatencyStretch.html" alt="I3LatencyStretch" shape="rect" coords="117,224,224,248"/>
<area href="classI3Multicast.html" alt="I3Multicast" shape="rect" coords="117,280,224,304"/>
<area href="classI3SessionClient.html" alt="I3SessionClient" shape="rect" coords="117,336,224,360"/>
<area href="classI3SessionServer.html" alt="I3SessionServer" shape="rect" coords="117,392,224,416"/>
<area href="classI3Triggers.html" alt="I3Triggers" shape="rect" coords="117,448,224,472"/>
<area href="classI3TRTClient.html" alt="I3TRTClient" shape="rect" coords="117,504,224,528"/>
</map>
</div>

<p><a href="classI3BaseApp-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structI3BaseApp_1_1I3CachedServer.html">I3CachedServer</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#aa2d84b4f6738fea695d820766f5408fa">I3BaseApp</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#aa2d84b4f6738fea695d820766f5408fa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ad503e948a0f9c7cf7d0e556cbc49cbdd">~I3BaseApp</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#ad503e948a0f9c7cf7d0e556cbc49cbdd"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a32aa3150a4ca4641c2e30fe3d2e80f5f">I3MobilityStage</a> { <a class="el" href="classI3BaseApp.html#a32aa3150a4ca4641c2e30fe3d2e80f5fa02c6e034c2cf79d3cd543fbb072d347f">I3_MOBILITY_BEFORE_UPDATE</a>, 
<a class="el" href="classI3BaseApp.html#a32aa3150a4ca4641c2e30fe3d2e80f5fa8095e5bea9811e8bb3c935269e1ff683">I3_MOBILITY_UPDATED</a>
 }</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#aa3af86e534f4d730be4ffe18e572a79c">numInitStages</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns number of init stages required.  <a href="#aa3af86e534f4d730be4ffe18e572a79c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ac3ae90bd739e17bb20ff652718042723">initialize</a> (int stage)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Basic initialization.  <a href="#ac3ae90bd739e17bb20ff652718042723"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#aa6066b4204c6e4c496ea6c08df1c13be">initializeApp</a> (int stage)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">App initialization - should be overwritten by application.  <a href="#aa6066b4204c6e4c496ea6c08df1c13be"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ac711dcf17641dbb71122f5534939560e">bootstrapI3</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> bootstrap - connects to <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>, inserts sampling triggers and initializes timers.  <a href="#ac711dcf17641dbb71122f5534939560e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a7b7893603824afa3611077883ee2d895">initializeI3</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Application <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> initialize - should be overwritten by application.  <a href="#a7b7893603824afa3611077883ee2d895"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ae5f1baab07cc0105d48bf3dc3ef7e057">handleTimerEvent</a> (cMessage *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handles timers - should be overwritten by application.  <a href="#ae5f1baab07cc0105d48bf3dc3ef7e057"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a18be16651d2518a0fb6af6eb3cb41e45">handleUDPMessage</a> (cMessage *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handles messages incoming from UDP gate.  <a href="#a18be16651d2518a0fb6af6eb3cb41e45"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#af3156b05919116f682ceac58635e8739">handleMessage</a> (cMessage *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handles incoming messages.  <a href="#af3156b05919116f682ceac58635e8739"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#aea71ddcedfef6a0c8d02cde51fcafac5">deliver</a> (<a class="el" href="classI3Trigger.html">I3Trigger</a> &amp;trigger, <a class="el" href="classI3IdentifierStack.html">I3IdentifierStack</a> &amp;stack, cPacket *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delivers packets coming from <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> - should be overwritten by application.  <a href="#aea71ddcedfef6a0c8d02cde51fcafac5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a5ec27766a5e352a0036913dc9fe7cc18">sendToI3</a> (<a class="el" href="classI3Message.html">I3Message</a> *msg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>.  <a href="#a5ec27766a5e352a0036913dc9fe7cc18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a08b3797a36f5db7aa40570dd71be46fc">sendThroughUDP</a> (cMessage *msg, const <a class="el" href="structI3IPAddress.html">I3IPAddress</a> &amp;ip)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message through UDP.  <a href="#a08b3797a36f5db7aa40570dd71be46fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a69aeb5da738cfea1722d4452de305f7b">refreshTriggers</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Refreshes (reinserts) stored triggers.  <a href="#a69aeb5da738cfea1722d4452de305f7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a62031bb4bf2bb53ecb37e8e981a27bf8">refreshSamples</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Refreshes sampling triggers and selects fastest server as gateway.  <a href="#a62031bb4bf2bb53ecb37e8e981a27bf8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classI3Identifier.html">I3Identifier</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a1af4d14d796637874b72c14a49549958">retrieveClosestIdentifier</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a68053b095070058352215964c5ad375e">sendPacket</a> (const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;id, cPacket *msg, bool useHint=false)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Routes a packet through <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>, passing an identifier stack composed of a single identifier.  <a href="#a68053b095070058352215964c5ad375e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#af4e31dfccf3dc75dd7a8b409ffa31a7a">sendPacket</a> (const <a class="el" href="classI3IdentifierStack.html">I3IdentifierStack</a> &amp;stack, cPacket *msg, bool useHint=false)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Routes a packet through <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>.  <a href="#af4e31dfccf3dc75dd7a8b409ffa31a7a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6">insertTrigger</a> (const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;identifier, bool store=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inserts a trigger into <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>, composed by the given identifier and an identifier stack containing only this node's IP address.  <a href="#a23337061eee9bd1792b3068894a992b6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ad15062b9d8c48a6e14da7a2674a1cb28">insertTrigger</a> (const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;identifier, const <a class="el" href="classI3IdentifierStack.html">I3IdentifierStack</a> &amp;stack, bool store=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inserts a trigger into <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> with the given identifier and identifier stack.  <a href="#ad15062b9d8c48a6e14da7a2674a1cb28"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a475891c714a0116b7ef531044a749d7c">insertTrigger</a> (const <a class="el" href="classI3Trigger.html">I3Trigger</a> &amp;t, bool store=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inserts the given trigger into <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>.  <a href="#a475891c714a0116b7ef531044a749d7c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#af3b756630dc30bc55e152699da9346f5">removeTrigger</a> (const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;identifier)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes all triggers from the list of inserted triggers whose identifiers equal the one given.  <a href="#af3b756630dc30bc55e152699da9346f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a68253a9f1958b785eeb228fba30b1a18">removeTrigger</a> (const <a class="el" href="classI3Trigger.html">I3Trigger</a> &amp;trigger)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes a trigger from <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>.  <a href="#a68253a9f1958b785eeb228fba30b1a18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classI3Trigger.html">I3Trigger</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a9391f2bd9265ec8aa783780a494fa40b">getInsertedTriggers</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the list of inserted triggers.  <a href="#a9391f2bd9265ec8aa783780a494fa40b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a50f46e045c65824949a221c12244a0ba">receiveChangeNotification</a> (int category, const cPolymorphic *details)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a9459ef2cc5568d02094c897d6dad58cf">doMobilityEvent</a> (<a class="el" href="classI3BaseApp.html#a32aa3150a4ca4641c2e30fe3d2e80f5f">I3MobilityStage</a> stage)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#aced3b8b7fdc0d78e1a4c1aabd066b02e">numSent</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of sent messages.  <a href="#aced3b8b7fdc0d78e1a4c1aabd066b02e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ac43cfddcbde6776668307bb00f1d19be">sentBytes</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ad358ae17066ac6f81728bb15bd04c3b7">numReceived</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of received messages.  <a href="#ad358ae17066ac6f81728bb15bd04c3b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a3bf7151c9eace249e6adb1a0ae247082">receivedBytes</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a307c1051e74b5d54e8296bddd8391be3">numIsolations</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of times this node has been isolated - i.e.  <a href="#a307c1051e74b5d54e8296bddd8391be3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">IPvXAddress&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676">nodeIPAddress</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cached IP address of this node.  <a href="#ac5f0e6bc96603ee017aaf3d681208676"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classI3Trigger.html">I3Trigger</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11">insertedTriggers</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stored <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> triggers sent from this node, to be refreshed automatically.  <a href="#a093782cbd28bcbce6c070fd582c2cd11"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classI3Identifier.html">I3Identifier</a>, <br class="typebreak"/>
<a class="el" href="structI3BaseApp_1_1I3CachedServer.html">I3CachedServer</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classI3Identifier.html">I3Identifier</a>, <br class="typebreak"/>
<a class="el" href="structI3BaseApp_1_1I3CachedServer.html">I3CachedServer</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structI3BaseApp_1_1I3CachedServer.html">I3CachedServer</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#aa765d4de34ee5931c8d86f7cfc7f4ee0">refreshTriggersTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a41579ebabece039a0c1e8da7f6439c72">refreshTriggersTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#aa8c2b57a7dcfe8c13d77dcd3956d315d">refreshSamplesTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a7c5c6cc8192891a9c95613ff3d9095ba">refreshSamplesTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#af3504810336d23fa3d2bbbd86efa07ce">initializeTimer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a3b5dc68c38b8bcd5e9d7ce5a36dcc97e">bootstrapTimer</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classI3BaseApp.html#a59b897def4737a6b076139f8d7ef5fd3">mobilityInStages</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Basic template class for <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> applications. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00041">41</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>
<hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="a32aa3150a4ca4641c2e30fe3d2e80f5f"></a><!-- doxytag: member="I3BaseApp::I3MobilityStage" ref="a32aa3150a4ca4641c2e30fe3d2e80f5f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classI3BaseApp.html#a32aa3150a4ca4641c2e30fe3d2e80f5f">I3BaseApp::I3MobilityStage</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a32aa3150a4ca4641c2e30fe3d2e80f5fa02c6e034c2cf79d3cd543fbb072d347f"></a><!-- doxytag: member="I3_MOBILITY_BEFORE_UPDATE" ref="a32aa3150a4ca4641c2e30fe3d2e80f5fa02c6e034c2cf79d3cd543fbb072d347f" args="" -->I3_MOBILITY_BEFORE_UPDATE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a32aa3150a4ca4641c2e30fe3d2e80f5fa8095e5bea9811e8bb3c935269e1ff683"></a><!-- doxytag: member="I3_MOBILITY_UPDATED" ref="a32aa3150a4ca4641c2e30fe3d2e80f5fa8095e5bea9811e8bb3c935269e1ff683" args="" -->I3_MOBILITY_UPDATED</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00062">62</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p><div class="fragment"><pre class="fragment">                         {
        I3_MOBILITY_BEFORE_UPDATE,
        <a class="code" href="classI3BaseApp.html#a32aa3150a4ca4641c2e30fe3d2e80f5fa8095e5bea9811e8bb3c935269e1ff683">I3_MOBILITY_UPDATED</a>
    };
</pre></div></p>

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa2d84b4f6738fea695d820766f5408fa"></a><!-- doxytag: member="I3BaseApp::I3BaseApp" ref="aa2d84b4f6738fea695d820766f5408fa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I3BaseApp::I3BaseApp </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00058">58</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad503e948a0f9c7cf7d0e556cbc49cbdd"></a><!-- doxytag: member="I3BaseApp::~I3BaseApp" ref="ad503e948a0f9c7cf7d0e556cbc49cbdd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">I3BaseApp::~I3BaseApp </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00062">62</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
}
</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ac711dcf17641dbb71122f5534939560e"></a><!-- doxytag: member="I3BaseApp::bootstrapI3" ref="ac711dcf17641dbb71122f5534939560e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::bootstrapI3 </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Internal <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> bootstrap - connects to <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>, inserts sampling triggers and initializes timers. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00121">121</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a> myAddress(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>, par(<span class="stringliteral">&quot;clientPort&quot;</span>));

    <span class="comment">// TODO: use BootstrapList instead of GlobalNodeList</span>
    <span class="keyword">const</span> <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a> handle = <a class="code" href="classGlobalNodeListAccess.html" title="Gives access to the GlobalNodeList.">GlobalNodeListAccess</a>().get()-&gt;getBootstrapNode();
    <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a918f76ec19bb88c76f717c704ef5180e">address</a> = <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a>(handle.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>(), par(<span class="stringliteral">&quot;serverPort&quot;</span>));

    <span class="keywordtype">int</span> cacheSize = par(<span class="stringliteral">&quot;cacheSize&quot;</span>);
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cacheSize; i++) {
        <a class="code" href="classI3Identifier.html">I3Identifier</a> id;

        <span class="keywordtype">id</span>.createRandomKey();

        ostringstream os;
        os &lt;&lt; myAddress &lt;&lt; <span class="stringliteral">&quot; sample&quot;</span> &lt;&lt; i;
        <span class="keywordtype">id</span>.setName(os.str());

        <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>[id] = I3CachedServer(); <span class="comment">// placeholder</span>

        <a class="code" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6" title="Inserts a trigger into I3, composed by the given identifier and an identifier stack containing only t...">insertTrigger</a>(<span class="keywordtype">id</span>, <span class="keyword">false</span>);
    }

    <a class="code" href="classI3BaseApp.html#aa765d4de34ee5931c8d86f7cfc7f4ee0">refreshTriggersTimer</a> = <span class="keyword">new</span> cMessage();
    <a class="code" href="classI3BaseApp.html#a41579ebabece039a0c1e8da7f6439c72">refreshTriggersTime</a> = par(<span class="stringliteral">&quot;triggerRefreshTime&quot;</span>);
    scheduleAt(simTime() + truncnormal(<a class="code" href="classI3BaseApp.html#a41579ebabece039a0c1e8da7f6439c72">refreshTriggersTime</a>, <a class="code" href="classI3BaseApp.html#a41579ebabece039a0c1e8da7f6439c72">refreshTriggersTime</a> / 10),
               <a class="code" href="classI3BaseApp.html#aa765d4de34ee5931c8d86f7cfc7f4ee0">refreshTriggersTimer</a>);

    <a class="code" href="classI3BaseApp.html#aa8c2b57a7dcfe8c13d77dcd3956d315d">refreshSamplesTimer</a> = <span class="keyword">new</span> cMessage();
    <a class="code" href="classI3BaseApp.html#a7c5c6cc8192891a9c95613ff3d9095ba">refreshSamplesTime</a> = par(<span class="stringliteral">&quot;sampleRefreshTime&quot;</span>);
    scheduleAt(simTime() + truncnormal(<a class="code" href="classI3BaseApp.html#a7c5c6cc8192891a9c95613ff3d9095ba">refreshSamplesTime</a>, <a class="code" href="classI3BaseApp.html#a7c5c6cc8192891a9c95613ff3d9095ba">refreshSamplesTime</a> / 10),
               <a class="code" href="classI3BaseApp.html#aa8c2b57a7dcfe8c13d77dcd3956d315d">refreshSamplesTimer</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aea71ddcedfef6a0c8d02cde51fcafac5"></a><!-- doxytag: member="I3BaseApp::deliver" ref="aea71ddcedfef6a0c8d02cde51fcafac5" args="(I3Trigger &amp;trigger, I3IdentifierStack &amp;stack, cPacket *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::deliver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classI3Trigger.html">I3Trigger</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>trigger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classI3IdentifierStack.html">I3IdentifierStack</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>stack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPacket *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delivers packets coming from <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> - should be overwritten by application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>trigger</em>&nbsp;</td><td>Application trigger to which the packet was sent </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stack</em>&nbsp;</td><td>Identifier stack passed from <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Arriving message </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classI3Anycast.html#a24c8d71b27b8461871c6898c3efe7e8d">I3Anycast</a>, <a class="el" href="classI3Composite.html#a261dba805ef57bd91e4f5b29f103d05b">I3Composite</a>, <a class="el" href="classI3HostMobility.html#a15cf7ee82d64382c5b0515574ebb1547">I3HostMobility</a>, <a class="el" href="classI3LatencyStretch.html#a5a12bbab61b7122c722a00112bb26a13">I3LatencyStretch</a>, <a class="el" href="classI3Multicast.html#afcf2797d0598f6fad0b5325c187400ca">I3Multicast</a>, <a class="el" href="classI3SessionServer.html#a1834c750d0924eebeff38e1054ae531d">I3SessionServer</a>, <a class="el" href="classI3SessionClient.html#a2951b6c833ed5f9d387bbe87fee9ee55">I3SessionClient</a>, and <a class="el" href="classI3Triggers.html#a2d29f37b06c4286c0ec4ef943c2bfa4f">I3Triggers</a>.</p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00189">189</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00199">handleUDPMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> msg;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9459ef2cc5568d02094c897d6dad58cf"></a><!-- doxytag: member="I3BaseApp::doMobilityEvent" ref="a9459ef2cc5568d02094c897d6dad58cf" args="(I3MobilityStage stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::doMobilityEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classI3BaseApp.html#a32aa3150a4ca4641c2e30fe3d2e80f5f">I3MobilityStage</a>&nbsp;</td>
          <td class="paramname"> <em>stage</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classI3HostMobility.html#afc82b9f41610fa943557f44571b2b71a">I3HostMobility</a>.</p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00547">547</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9391f2bd9265ec8aa783780a494fa40b"></a><!-- doxytag: member="I3BaseApp::getInsertedTriggers" ref="a9391f2bd9265ec8aa783780a494fa40b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">set&lt; <a class="el" href="classI3Trigger.html">I3Trigger</a> &gt; &amp; I3BaseApp::getInsertedTriggers </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the list of inserted triggers. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00472">472</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af3156b05919116f682ceac58635e8739"></a><!-- doxytag: member="I3BaseApp::handleMessage" ref="af3156b05919116f682ceac58635e8739" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handles incoming messages. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Incoming message </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00160">160</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (msg-&gt;isSelfMessage()) {
        <span class="keywordflow">if</span> (msg == <a class="code" href="classI3BaseApp.html#a3b5dc68c38b8bcd5e9d7ce5a36dcc97e">bootstrapTimer</a>) {
            <a class="code" href="classI3BaseApp.html#ac711dcf17641dbb71122f5534939560e" title="Internal I3 bootstrap - connects to I3, inserts sampling triggers and initializes timers...">bootstrapI3</a>();
            <span class="keyword">delete</span> msg;
            <a class="code" href="classI3BaseApp.html#a3b5dc68c38b8bcd5e9d7ce5a36dcc97e">bootstrapTimer</a> = 0;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg == <a class="code" href="classI3BaseApp.html#af3504810336d23fa3d2bbbd86efa07ce">initializeTimer</a>)  {
            <a class="code" href="classI3BaseApp.html#a7b7893603824afa3611077883ee2d895" title="Application I3 initialize - should be overwritten by application.">initializeI3</a>();
            <span class="keyword">delete</span> msg;
            <a class="code" href="classI3BaseApp.html#af3504810336d23fa3d2bbbd86efa07ce">initializeTimer</a> = 0;
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg == <a class="code" href="classI3BaseApp.html#aa765d4de34ee5931c8d86f7cfc7f4ee0">refreshTriggersTimer</a>) {
            <a class="code" href="classI3BaseApp.html#a69aeb5da738cfea1722d4452de305f7b" title="Refreshes (reinserts) stored triggers.">refreshTriggers</a>();
            scheduleAt(simTime() + truncnormal(<a class="code" href="classI3BaseApp.html#a41579ebabece039a0c1e8da7f6439c72">refreshTriggersTime</a>, <a class="code" href="classI3BaseApp.html#a41579ebabece039a0c1e8da7f6439c72">refreshTriggersTime</a> / 10),
                       <a class="code" href="classI3BaseApp.html#aa765d4de34ee5931c8d86f7cfc7f4ee0">refreshTriggersTimer</a>);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg == <a class="code" href="classI3BaseApp.html#aa8c2b57a7dcfe8c13d77dcd3956d315d">refreshSamplesTimer</a>) {
            <a class="code" href="classI3BaseApp.html#a62031bb4bf2bb53ecb37e8e981a27bf8" title="Refreshes sampling triggers and selects fastest server as gateway.">refreshSamples</a>();
            scheduleAt(simTime() + truncnormal(<a class="code" href="classI3BaseApp.html#a7c5c6cc8192891a9c95613ff3d9095ba">refreshSamplesTime</a>, <a class="code" href="classI3BaseApp.html#a7c5c6cc8192891a9c95613ff3d9095ba">refreshSamplesTime</a> / 10),
                       <a class="code" href="classI3BaseApp.html#aa8c2b57a7dcfe8c13d77dcd3956d315d">refreshSamplesTimer</a>);
        } <span class="keywordflow">else</span> {
            <a class="code" href="classI3BaseApp.html#ae5f1baab07cc0105d48bf3dc3ef7e057" title="Handles timers - should be overwritten by application.">handleTimerEvent</a>(msg);
        }
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;arrivedOn(<span class="stringliteral">&quot;udpIn&quot;</span>)) {
        <a class="code" href="classI3BaseApp.html#a18be16651d2518a0fb6af6eb3cb41e45" title="Handles messages incoming from UDP gate.">handleUDPMessage</a>(msg);
    } <span class="keywordflow">else</span> {
        <span class="keyword">delete</span> msg;
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5f1baab07cc0105d48bf3dc3ef7e057"></a><!-- doxytag: member="I3BaseApp::handleTimerEvent" ref="ae5f1baab07cc0105d48bf3dc3ef7e057" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::handleTimerEvent </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handles timers - should be overwritten by application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Timer to be handled </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classI3Anycast.html#acc0111d97bbd6be1d8431fbb3495161a">I3Anycast</a>, <a class="el" href="classI3Composite.html#ab2d8a21d56813823de60bebfd97cd1d4">I3Composite</a>, <a class="el" href="classI3HostMobility.html#a477c0ea951d0f7b4fb3ebd7e155c122d">I3HostMobility</a>, <a class="el" href="classI3LatencyStretch.html#a3dc08a34b811e6bff0e3b8181e86f03e">I3LatencyStretch</a>, <a class="el" href="classI3Multicast.html#a128598c95082a9190ba7979154a85470">I3Multicast</a>, <a class="el" href="classI3SessionClient.html#ac8a72a780a40fe85a3cc2ecf57b70403">I3SessionClient</a>, <a class="el" href="classI3TRTClient.html#aba11cf3db6d21a1f4856aa5bbf2c8f93">I3TRTClient</a>, and <a class="el" href="classI3Triggers.html#ad7221a908e5c5dcb25c7946204b15428">I3Triggers</a>.</p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00194">194</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keyword">delete</span> msg;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a18be16651d2518a0fb6af6eb3cb41e45"></a><!-- doxytag: member="I3BaseApp::handleUDPMessage" ref="a18be16651d2518a0fb6af6eb3cb41e45" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::handleUDPMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handles messages incoming from UDP gate. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Message sent </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classI3HostMobility.html#aa952ccfd8fa68643560c7bb60f0ddca2">I3HostMobility</a>, and <a class="el" href="classI3LatencyStretch.html#a40baa2f7de222de7a15dcb11a6fc4a8f">I3LatencyStretch</a>.</p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00199">199</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3Message.html" title="Class generated from applications/i3/I3Message.msg by opp_msgc.">I3Message</a> *i3msg;

    i3msg = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classI3Message.html" title="Class generated from applications/i3/I3Message.msg by opp_msgc.">I3Message</a>*<span class="keyword">&gt;</span>(msg);
    <span class="keywordflow">if</span> (i3msg) {
        <span class="keywordflow">switch</span> (i3msg-&gt;<a class="code" href="classI3Message.html#abd2d0964bb06d466f4fc81c7179b689f">getType</a>()) {
        <span class="keywordflow">case</span> <a class="code" href="I3Message__m_8h.html#aabd1e55c19381bd63c1b4d47c5409afead25076dd974810d50835d534cc94950c">SEND_PACKET</a>:
        {
            <a class="code" href="classI3SendPacketMessage.html">I3SendPacketMessage</a> *smsg;

            smsg = check_and_cast&lt;<a class="code" href="classI3SendPacketMessage.html">I3SendPacketMessage</a>*&gt;(msg);
            <a class="code" href="classI3BaseApp.html#ad358ae17066ac6f81728bb15bd04c3b7" title="Number of received messages.">numReceived</a>++;
            <a class="code" href="classI3BaseApp.html#a3bf7151c9eace249e6adb1a0ae247082">receivedBytes</a> += smsg-&gt;getByteLength();

            <span class="comment">/* deliver to app */</span>
            cPacket *newMessage = smsg-&gt;decapsulate();
            <a class="code" href="classI3BaseApp.html#aea71ddcedfef6a0c8d02cde51fcafac5" title="Delivers packets coming from I3 - should be overwritten by application.">deliver</a>(smsg-&gt;<a class="code" href="classI3SendPacketMessage__Base.html#a5e02e5ee4a4f07a09f0f294c321d1c89">getMatchedTrigger</a>(), smsg-&gt;<a class="code" href="classI3SendPacketMessage__Base.html#af0180ec364a7d5c110d62419e1f615b8">getIdentifierStack</a>(), newMessage);

            <span class="keywordflow">break</span>;
        }
        <span class="keywordflow">case</span> <a class="code" href="I3Message__m_8h.html#aabd1e55c19381bd63c1b4d47c5409afeafb1fb3e4b863935162d5a1ef755938f8">QUERY_REPLY</a>:
        {
            <a class="code" href="classI3QueryReplyMessage.html">I3QueryReplyMessage</a> *pmsg;
            pmsg = check_and_cast&lt;<a class="code" href="classI3QueryReplyMessage.html">I3QueryReplyMessage</a>*&gt;(msg);
            <a class="code" href="classI3Identifier.html">I3Identifier</a> &amp;<span class="keywordtype">id</span> = pmsg-&gt;<a class="code" href="classI3QueryReplyMessage__Base.html#a75ec3db76e4e2e9080475aaf40fa586b">getIdentifier</a>();

            <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>[id].address = pmsg-&gt;<a class="code" href="classI3QueryReplyMessage__Base.html#aaae827384104488dc5d6c04f159d5481">getSource</a>();
            <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>[id].lastReply = simTime();
            <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>[id].roundTripTime = simTime() - pmsg-&gt;<a class="code" href="classI3QueryReplyMessage__Base.html#a179d64efa60f1f7292ca06e3814ee1cb">getSendingTime</a>();

            <span class="keywordflow">if</span> (<a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.count(<span class="keywordtype">id</span>) != 0) {
                <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>[id] = <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>[id];
            }
            <span class="keywordflow">break</span>;
        }
        <span class="keywordflow">default</span>:
            <span class="comment">/* shouldn&#39;t get here */</span>
            <span class="keywordflow">break</span>;
        }
    }
    <span class="keyword">delete</span> msg;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac3ae90bd739e17bb20ff652718042723"></a><!-- doxytag: member="I3BaseApp::initialize" ref="ac3ae90bd739e17bb20ff652718042723" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::initialize </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Basic initialization. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00071">71</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (stage != <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532ad9afa81d0184c5f0649fa111f7a821bc" title="deprecated">MIN_STAGE_APP</a>) <span class="keywordflow">return</span>;

    <a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a> = IPAddressResolver().addressOf(getParentModule());

    bindToPort(par(<span class="stringliteral">&quot;clientPort&quot;</span>));
    <span class="comment">/*    NotificationBoardAccess().get()-&gt;subscribe(this, NF_HOSTPOSITION_BEFOREUPDATE);</span>
<span class="comment">        NotificationBoardAccess().get()-&gt;subscribe(this, NF_HOSTPOSITION_UPDATED);*/</span>

    getDisplayString().setTagArg(<span class="stringliteral">&quot;i&quot;</span>, 0, <span class="stringliteral">&quot;i3c&quot;</span>);
    getParentModule()-&gt;getDisplayString().removeTag(<span class="stringliteral">&quot;i2&quot;</span>);

    <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(par(<span class="stringliteral">&quot;bootstrapTime&quot;</span>)) &gt;= <span class="keywordtype">int</span>(par(<span class="stringliteral">&quot;initTime&quot;</span>))) {
        opp_error(<span class="stringliteral">&quot;Parameter bootstrapTime must be smaller than initTime&quot;</span>);
    }

    <a class="code" href="classI3BaseApp.html#a3b5dc68c38b8bcd5e9d7ce5a36dcc97e">bootstrapTimer</a> = <span class="keyword">new</span> cMessage();
    scheduleAt(simTime() + <span class="keywordtype">int</span>(par(<span class="stringliteral">&quot;bootstrapTime&quot;</span>)), <a class="code" href="classI3BaseApp.html#a3b5dc68c38b8bcd5e9d7ce5a36dcc97e">bootstrapTimer</a>);

    <a class="code" href="classI3BaseApp.html#af3504810336d23fa3d2bbbd86efa07ce">initializeTimer</a> = <span class="keyword">new</span> cMessage();
    scheduleAt(simTime() + <span class="keywordtype">int</span>(par(<span class="stringliteral">&quot;initTime&quot;</span>)), <a class="code" href="classI3BaseApp.html#af3504810336d23fa3d2bbbd86efa07ce">initializeTimer</a>);

    <a class="code" href="classI3BaseApp.html#aced3b8b7fdc0d78e1a4c1aabd066b02e" title="Number of sent messages.">numSent</a> = 0;
    <a class="code" href="classI3BaseApp.html#ac43cfddcbde6776668307bb00f1d19be">sentBytes</a> = 0;
    <a class="code" href="classI3BaseApp.html#ad358ae17066ac6f81728bb15bd04c3b7" title="Number of received messages.">numReceived</a> = 0;
    <a class="code" href="classI3BaseApp.html#a3bf7151c9eace249e6adb1a0ae247082">receivedBytes</a> = 0;
    <a class="code" href="classI3BaseApp.html#a307c1051e74b5d54e8296bddd8391be3" title="Number of times this node has been isolated - i.e.">numIsolations</a> = 0;
    <a class="code" href="classI3BaseApp.html#a59b897def4737a6b076139f8d7ef5fd3">mobilityInStages</a> = <span class="keyword">false</span>;

    WATCH(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>);
    WATCH(<a class="code" href="classI3BaseApp.html#aced3b8b7fdc0d78e1a4c1aabd066b02e" title="Number of sent messages.">numSent</a>);
    WATCH(<a class="code" href="classI3BaseApp.html#ac43cfddcbde6776668307bb00f1d19be">sentBytes</a>);
    WATCH(<a class="code" href="classI3BaseApp.html#ad358ae17066ac6f81728bb15bd04c3b7" title="Number of received messages.">numReceived</a>);
    WATCH(<a class="code" href="classI3BaseApp.html#a3bf7151c9eace249e6adb1a0ae247082">receivedBytes</a>);
    WATCH(<a class="code" href="classI3BaseApp.html#a307c1051e74b5d54e8296bddd8391be3" title="Number of times this node has been isolated - i.e.">numIsolations</a>);


    WATCH_SET(<a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>);
    WATCH(<a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>);
    WATCH_MAP(<a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>);
    WATCH_MAP(<a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>);

    <a class="code" href="classI3BaseApp.html#aa6066b4204c6e4c496ea6c08df1c13be" title="App initialization - should be overwritten by application.">initializeApp</a>(stage);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa6066b4204c6e4c496ea6c08df1c13be"></a><!-- doxytag: member="I3BaseApp::initializeApp" ref="aa6066b4204c6e4c496ea6c08df1c13be" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::initializeApp </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>App initialization - should be overwritten by application. </p>
<p><a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> related commands should go in initializeI3. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stage</em>&nbsp;</td><td>Initialization stage passed from <a class="el" href="classI3BaseApp.html#ac3ae90bd739e17bb20ff652718042723" title="Basic initialization.">initialize()</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classI3Anycast.html#ace970d6151df253e095bf87a777486ea">I3Anycast</a>, <a class="el" href="classI3Composite.html#aa806a6057a5989364f2630b6471d5e4b">I3Composite</a>, <a class="el" href="classI3HostMobility.html#a2aed9fc4794a59f0a258d0be4a3ed7e1">I3HostMobility</a>, <a class="el" href="classI3LatencyStretch.html#a7f4c8598d5cc0521e08015eb48926b66">I3LatencyStretch</a>, <a class="el" href="classI3Multicast.html#aabf3bdb7719bbb779b4c5b6d360a5b9c">I3Multicast</a>, <a class="el" href="classI3SessionClient.html#a975b5842685e4b5b8074da5c2f5e4b56">I3SessionClient</a>, and <a class="el" href="classI3Triggers.html#ae68f54311acc5de1a98d4a5b2131e58f">I3Triggers</a>.</p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00117">117</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7b7893603824afa3611077883ee2d895"></a><!-- doxytag: member="I3BaseApp::initializeI3" ref="a7b7893603824afa3611077883ee2d895" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::initializeI3 </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Application <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> initialize - should be overwritten by application. </p>

<p>Reimplemented in <a class="el" href="classI3Anycast.html#a216937cf33b630d75b50240d02905144">I3Anycast</a>, <a class="el" href="classI3Composite.html#a143b0872a45ce875526a7b985e6e3fb2">I3Composite</a>, <a class="el" href="classI3HostMobility.html#a344cb84d62c20ea4f4c8f70b0128d3bb">I3HostMobility</a>, <a class="el" href="classI3LatencyStretch.html#aada68081678f8b66d294a1f1c483a780">I3LatencyStretch</a>, <a class="el" href="classI3Multicast.html#a3614b98da2218f1bd395b2e2f56a8427">I3Multicast</a>, <a class="el" href="classI3SessionServer.html#a689ce8e1ab68667ed6ccc8b869250e44">I3SessionServer</a>, <a class="el" href="classI3SessionClient.html#a98f51bc3572253299c060b0e3d68e530">I3SessionClient</a>, <a class="el" href="classI3SessionClientStarter.html#a3cae4719127153df77e47ea152e1c7c1">I3SessionClientStarter</a>, <a class="el" href="classI3TRTClient.html#aa0a6dada3a59eb784e3e5e9e63be90c8">I3TRTClient</a>, and <a class="el" href="classI3Triggers.html#a2a70701c14daf78bcddeb5825edbe544">I3Triggers</a>.</p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00155">155</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment">{

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a23337061eee9bd1792b3068894a992b6"></a><!-- doxytag: member="I3BaseApp::insertTrigger" ref="a23337061eee9bd1792b3068894a992b6" args="(const I3Identifier &amp;identifier, bool store=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::insertTrigger </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>identifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>store</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Inserts a trigger into <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>, composed by the given identifier and an identifier stack containing only this node's IP address. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>identifier</em>&nbsp;</td><td>Trigger's identifier </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>store</em>&nbsp;</td><td>Sets whether to store the trigger for auto-refresh </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00412">412</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, <a class="el" href="I3Triggers_8cc_source.html#l00117">I3Triggers::deliver()</a>, <a class="el" href="I3Session_8cc_source.html#l00125">I3SessionClient::deliver()</a>, <a class="el" href="I3HostMobility_8cc_source.html#l00133">I3HostMobility::handleTimerEvent()</a>, <a class="el" href="I3Triggers_8cc_source.html#l00070">I3Triggers::initializeI3()</a>, <a class="el" href="I3Session_8cc_source.html#l00246">I3SessionClientStarter::initializeI3()</a>, <a class="el" href="I3Session_8cc_source.html#l00119">I3SessionClient::initializeI3()</a>, <a class="el" href="I3Session_8cc_source.html#l00059">I3SessionServer::initializeI3()</a>, <a class="el" href="I3Multicast_8cc_source.html#l00048">I3Multicast::initializeI3()</a>, <a class="el" href="I3LatencyStretch_8cc_source.html#l00135">I3LatencyStretch::initializeI3()</a>, <a class="el" href="I3HostMobility_8cc_source.html#l00078">I3HostMobility::initializeI3()</a>, <a class="el" href="I3Composite_8cc_source.html#l00066">I3Composite::initializeI3()</a>, <a class="el" href="I3Anycast_8cc_source.html#l00055">I3Anycast::initializeI3()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00422">insertTrigger()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00332">refreshSamples()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00264">refreshTriggers()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00344">retrieveClosestIdentifier()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3Trigger.html" title="Implementation of an Internet Indirection Infrastructure trigger.">I3Trigger</a> trigger;
    <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a> add(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>, par(<span class="stringliteral">&quot;clientPort&quot;</span>));;

    trigger.<a class="code" href="classI3Trigger.html#aa9151cb1f263902d4aff32f8d9ea56c3" title="Returns the insertion time.">getIdentifierStack</a>().<a class="code" href="classI3IdentifierStack.html#aea6b94c0f8f1c52e5ea5a16f31927655" title="Pushes an I3Identifier.">push</a>(add);
    trigger.<a class="code" href="classI3Trigger.html#a725ac2b3320c84d6b22d3afec2b50870" title="Sets the identifier.">setIdentifier</a>(identifier);
    <a class="code" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6" title="Inserts a trigger into I3, composed by the given identifier and an identifier stack containing only t...">insertTrigger</a>(trigger, store);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad15062b9d8c48a6e14da7a2674a1cb28"></a><!-- doxytag: member="I3BaseApp::insertTrigger" ref="ad15062b9d8c48a6e14da7a2674a1cb28" args="(const I3Identifier &amp;identifier, const I3IdentifierStack &amp;stack, bool store=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::insertTrigger </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>identifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classI3IdentifierStack.html">I3IdentifierStack</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>stack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>store</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Inserts a trigger into <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> with the given identifier and identifier stack. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>identifier</em>&nbsp;</td><td>Trigger's identifier </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stack</em>&nbsp;</td><td>Trigger's identifier stack </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>store</em>&nbsp;</td><td>Sets whether to store the trigger for auto-refresh </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00422">422</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3Trigger.html" title="Implementation of an Internet Indirection Infrastructure trigger.">I3Trigger</a> trigger;

    trigger.<a class="code" href="classI3Trigger.html#a725ac2b3320c84d6b22d3afec2b50870" title="Sets the identifier.">setIdentifier</a>(identifier);
    trigger.<a class="code" href="classI3Trigger.html#aa9151cb1f263902d4aff32f8d9ea56c3" title="Returns the insertion time.">getIdentifierStack</a>() = stack;
    <a class="code" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6" title="Inserts a trigger into I3, composed by the given identifier and an identifier stack containing only t...">insertTrigger</a>(trigger, store);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a475891c714a0116b7ef531044a749d7c"></a><!-- doxytag: member="I3BaseApp::insertTrigger" ref="a475891c714a0116b7ef531044a749d7c" args="(const I3Trigger &amp;t, bool store=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::insertTrigger </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classI3Trigger.html">I3Trigger</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>store</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Inserts the given trigger into <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t</em>&nbsp;</td><td>Trigger to be inserted </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>store</em>&nbsp;</td><td>Sets whether to store the trigger for auto-refresh </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00431">431</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">                                                            {

    <span class="keywordflow">if</span> (store) {
        <span class="keywordflow">if</span> (<a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.count(t) != 0) <span class="keywordflow">return</span>;
        <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.insert(t);
    }

    <a class="code" href="classI3InsertTriggerMessage.html">I3InsertTriggerMessage</a> *msg = <span class="keyword">new</span> <a class="code" href="classI3InsertTriggerMessage.html">I3InsertTriggerMessage</a>();
    <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a> myAddress(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>, par(<span class="stringliteral">&quot;clientPort&quot;</span>));

    msg-&gt;<a class="code" href="classI3InsertTriggerMessage__Base.html#ad674edb1988771db8648d72347675c5c">setTrigger</a>(t);
    msg-&gt;<a class="code" href="classI3InsertTriggerMessage__Base.html#ad58814bb2dac2af6ab6cb01a32574220">setSendReply</a>(<span class="keyword">true</span>);
    msg-&gt;<a class="code" href="classI3InsertTriggerMessage__Base.html#a3cb429d9ecf7dfbe3c3774040446c4ce">setSource</a>(myAddress);
    msg-&gt;setBitLength(<a class="code" href="I3Message__m_8h.html#a2225e9cc2a027ee6c4980135bd2be566">INSERT_TRIGGER_L</a>(msg));

    <a class="code" href="classI3BaseApp.html#a08b3797a36f5db7aa40570dd71be46fc" title="Sends a message through UDP.">sendThroughUDP</a>(msg, <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a918f76ec19bb88c76f717c704ef5180e">address</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa3af86e534f4d730be4ffe18e572a79c"></a><!-- doxytag: member="I3BaseApp::numInitStages" ref="aa3af86e534f4d730be4ffe18e572a79c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I3BaseApp::numInitStages </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns number of init stages required. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00066">66</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532a735021fae11712b786e515700dfdb5d1" title="deprecated">MAX_STAGE_APP</a> + 1;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a50f46e045c65824949a221c12244a0ba"></a><!-- doxytag: member="I3BaseApp::receiveChangeNotification" ref="a50f46e045c65824949a221c12244a0ba" args="(int category, const cPolymorphic *details)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::receiveChangeNotification </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>category</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const cPolymorphic *&nbsp;</td>
          <td class="paramname"> <em>details</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00477">477</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    Enter_Method_Silent();

    <span class="comment">/* Mobility is happening (the only event we are subscribed to). We have two things to do:</span>
<span class="comment">    * 1) Insert triggers with new IP</span>
<span class="comment">    * 2) Delete triggers with old IP</span>
<span class="comment">    * If it&#39;s one staged mobility, we just get told the IP after it&#39;s changed, and we need to make sure</span>
<span class="comment">    * step 1 and 2 are done. If it&#39;s two staged mobility, we need to make sure we do step 1 first and then</span>
<span class="comment">    * step 2. */</span>

<span class="comment">//     if (!mobilityInStages) { /* if the flag isn&#39;t set, mobility isn&#39;t done in stages or this is stage 1 */</span>
<span class="comment">//         if (category == NF_HOSTPOSITION_BEFOREUPDATE) {</span>
<span class="comment">//             mobilityInStages = true; /* set the flag so we don&#39;t land here in stage 2 again */</span>
<span class="comment">//         }</span>
<span class="comment">//         /* do part 1! */</span>
<span class="comment">//         cMessage *msg = check_and_cast&lt;cMessage*&gt;(details);</span>
<span class="comment">//         IPvXAddress *ipAddr = (IPvXAddress*)msg-&gt;getContextPointer();</span>
<span class="comment">//</span>
<span class="comment">//         ostringstream os;</span>
<span class="comment">//         os &lt;&lt; &quot;Mobility first stage - actual IP is &quot; &lt;&lt; nodeIPAddress &lt;&lt; &quot;, future IP is &quot; &lt;&lt; *ipAddr &lt;&lt; endl;</span>
<span class="comment">//         getParentModule()-&gt;bubble(os.str().c_str());</span>
<span class="comment">//</span>
<span class="comment">//         std::cout &lt;&lt; &quot;In advance from &quot; &lt;&lt; nodeIPAddress &lt;&lt; &quot; to &quot; &lt;&lt; *ipAddr &lt;&lt; endl;</span>
<span class="comment">//         I3IPAddress oldAddress(nodeIPAddress, par(&quot;clientPort&quot;));</span>
<span class="comment">//         I3IPAddress newAddress(*ipAddr, par(&quot;clientPort&quot;));</span>
<span class="comment">//</span>
<span class="comment">//         delete ipAddr;</span>
<span class="comment">//         delete msg;</span>
<span class="comment">//</span>
<span class="comment">//         for (set&lt;I3Trigger&gt;::iterator it = insertedTriggers.begin(); it != insertedTriggers.end(); it++) {</span>
<span class="comment">//             I3Trigger trigger(*it); /* create copy */</span>
<span class="comment">//             trigger.getIdentifierStack().replaceAddress(oldAddress, newAddress); /* replace old address with new */</span>
<span class="comment">//             insertTrigger(trigger, false); /* insert trigger in I3, but don&#39;t store it in our list yet - that&#39;s done in part 2 */</span>
<span class="comment">//         }</span>
<span class="comment">//</span>
<span class="comment">//         doMobilityEvent(I3_MOBILITY_BEFORE_UPDATE);</span>
<span class="comment">//     }</span>
<span class="comment">//     if (category == NF_HOSTPOSITION_UPDATED) { /* part 2: both for 1-stage and stage 2 of 2-stage mobility */</span>
<span class="comment">//         I3IPAddress oldAddress(nodeIPAddress, par(&quot;clientPort&quot;));</span>
<span class="comment">//         nodeIPAddress = IPAddressResolver().addressOf(getParentModule()).get4();</span>
<span class="comment">//         I3IPAddress newAddress(nodeIPAddress, par(&quot;clientPort&quot;));</span>
<span class="comment">//</span>
<span class="comment">//         cout &lt;&lt; &quot;After from &quot; &lt;&lt; oldAddress &lt;&lt; &quot; to &quot; &lt;&lt; newAddress &lt;&lt; endl;</span>
<span class="comment">//</span>
<span class="comment">//         ostringstream os;</span>
<span class="comment">//         os &lt;&lt; &quot;Mobility second stage - setting IP as &quot; &lt;&lt; newAddress &lt;&lt; endl;</span>
<span class="comment">//         getParentModule()-&gt;bubble(os.str().c_str());</span>
<span class="comment">//</span>
<span class="comment">//         set&lt;I3Trigger&gt; newSet; /* list of new triggers (that we already inserted in I3 in stage 1) */</span>
<span class="comment">//</span>
<span class="comment">//         for (set&lt;I3Trigger&gt;::iterator it = insertedTriggers.begin(); it != insertedTriggers.end(); it++) {</span>
<span class="comment">//             I3Trigger trigger(*it); /* create copy */</span>
<span class="comment">//</span>
<span class="comment">//             trigger.getIdentifierStack().replaceAddress(oldAddress, newAddress); /* replace old address with new */</span>
<span class="comment">//             newSet.insert(trigger); /* insert in new list */</span>
<span class="comment">//</span>
<span class="comment">//             removeTrigger(*it);  /* remove trigger from I3 and out list */</span>
<span class="comment">//</span>
<span class="comment">//         }</span>
<span class="comment">//         insertedTriggers = newSet; /* replace old list with updated one */</span>
<span class="comment">//</span>
<span class="comment">//         mobilityInStages = false; /* reset variable */</span>
<span class="comment">//         refreshTriggers(); /* to get new trigger round-trip times, new cache list */</span>
<span class="comment">//      refreshSamples();</span>
<span class="comment">//</span>
<span class="comment">//         doMobilityEvent(I3_MOBILITY_UPDATED);</span>
<span class="comment">//     }</span>
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a62031bb4bf2bb53ecb37e8e981a27bf8"></a><!-- doxytag: member="I3BaseApp::refreshSamples" ref="a62031bb4bf2bb53ecb37e8e981a27bf8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::refreshSamples </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Refreshes sampling triggers and selects fastest server as gateway. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00332">332</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment">                               {
    map&lt;I3Identifier, I3CachedServer&gt;::iterator mit;

    EV &lt;&lt; <span class="stringliteral">&quot;I3BaseApp::refreshSamples()]\n&quot;</span>
       &lt;&lt; <span class="stringliteral">&quot;    Refresh samples!&quot;</span>
       &lt;&lt; endl;
    <span class="comment">/* reinsert sample triggers */</span>
    <span class="keywordflow">for</span> (mit = <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.begin(); mit != <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.end(); mit++) {
        <a class="code" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6" title="Inserts a trigger into I3, composed by the given identifier and an identifier stack containing only t...">insertTrigger</a>(mit-&gt;first, <span class="keyword">false</span>);
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a69aeb5da738cfea1722d4452de305f7b"></a><!-- doxytag: member="I3BaseApp::refreshTriggers" ref="a69aeb5da738cfea1722d4452de305f7b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::refreshTriggers </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Refreshes (reinserts) stored triggers. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00264">264</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a> myAddress(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>, par(<span class="stringliteral">&quot;clientPort&quot;</span>));
    map&lt;I3Identifier, I3CachedServer&gt;::iterator mit;


    <span class="comment">// pick fastest I3 server as gateway</span>
    <span class="keywordtype">int</span> serverTimeout = par(<span class="stringliteral">&quot;serverTimeout&quot;</span>);
    <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a204f5f4a9eac42a12bc4fafd585c90c0">roundTripTime</a> = serverTimeout;
    <a class="code" href="classI3Identifier.html">I3Identifier</a> gatewayId;
    <span class="keywordflow">for</span> (mit = <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.begin(); mit != <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.end(); mit++) {
        <span class="keywordflow">if</span> (<a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a204f5f4a9eac42a12bc4fafd585c90c0">roundTripTime</a> &gt; mit-&gt;second.roundTripTime) {
            gatewayId = mit-&gt;first;
            <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a> = mit-&gt;second;
        }
    }

    <span class="comment">// check if gateway has timeout&#39;ed</span>
    <span class="keywordflow">if</span> (simTime() - <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a88fffbf8a14014d2cc48a5c77b602e06">lastReply</a> &gt;= serverTimeout) {
        <span class="comment">// We have a small problem here: if the fastest server has timeout,</span>
        <span class="comment">// that means the previous gateway had stopped responding some time before and no triggers were refreshed.</span>
        <span class="comment">// Since all servers have timeout&#39;ed by now and we can&#39;t trust return times, pick a random server and hope that one is alive.</span>
        <span class="keywordtype">int</span> random = intrand(<a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.size()), i;

        EV &lt;&lt; <span class="stringliteral">&quot;I3BaseApp::refreshTriggers()]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    Gateway timeout at &quot;</span> &lt;&lt; <a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>
           &lt;&lt; <span class="stringliteral">&quot;, time &quot;</span> &lt;&lt; simTime()
           &lt;&lt; <span class="stringliteral">&quot;; expired gateway is &quot;</span> &lt;&lt; <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a> &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; gatewayId &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; with last reply at &quot;</span> &lt;&lt; <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a88fffbf8a14014d2cc48a5c77b602e06">lastReply</a>
           &lt;&lt; endl;

        <span class="keywordflow">for</span> (i = 0, mit = <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.begin(); i &lt; random; i++, mit++);
        <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a> = mit-&gt;second;
        EV &lt;&lt; <span class="stringliteral">&quot;I3BaseApp::refreshTriggers()]\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;    New gateway for &quot;</span> &lt;&lt; <a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>
           &lt;&lt; endl;

        <span class="keywordflow">if</span> (<a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a204f5f4a9eac42a12bc4fafd585c90c0">roundTripTime</a> &gt; 2 * serverTimeout) {
            EV &lt;&lt; <span class="stringliteral">&quot;I3BaseApp::refreshTriggers()]\n&quot;</span>
               &lt;&lt; <span class="stringliteral">&quot;    New gateway&#39;s (&quot;</span> &lt;&lt; <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a> &lt;&lt; <span class="stringliteral">&quot;) rtt for &quot;</span> &lt;&lt; <a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>
               &lt;&lt; <span class="stringliteral">&quot; too high... marking as isolated!&quot;</span>
               &lt;&lt; endl;
            <a class="code" href="classI3BaseApp.html#a307c1051e74b5d54e8296bddd8391be3" title="Number of times this node has been isolated - i.e.">numIsolations</a>++;
            <span class="keyword">const</span> <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a> handle = <a class="code" href="classGlobalNodeListAccess.html" title="Gives access to the GlobalNodeList.">GlobalNodeListAccess</a>().get()-&gt;getBootstrapNode();
            <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a918f76ec19bb88c76f717c704ef5180e">address</a> = <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a>(handle.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>(), par(<span class="stringliteral">&quot;serverPort&quot;</span>));
        }
    }

    <span class="comment">/* ping gateway */</span>
    <a class="code" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6" title="Inserts a trigger into I3, composed by the given identifier and an identifier stack containing only t...">insertTrigger</a>(gatewayId, <span class="keyword">false</span>);
<span class="comment">//    cout &lt;&lt; &quot;Client &quot; &lt;&lt; nodeIPAddress &lt;&lt; &quot; pings &quot; &lt;&lt; gatewayId &lt;&lt; endl;</span>

    <span class="comment">/* reinsert stored triggers */</span>
    set&lt;I3Trigger&gt;::iterator it;
    <span class="keywordflow">for</span> (it = <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.begin(); it != <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.end(); it++) {
        <a class="code" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6" title="Inserts a trigger into I3, composed by the given identifier and an identifier stack containing only t...">insertTrigger</a>(*it, <span class="keyword">false</span>);
    }

    <span class="comment">/* now that we are refreshing stuff, might as well erase old identifier cache entries */</span>
    <span class="keywordtype">int</span> idStoreTime = par(<span class="stringliteral">&quot;idStoreTime&quot;</span>);
    <span class="keywordflow">for</span> (mit = <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>.begin(); mit != <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>.end(); mit++) {
        <span class="keywordflow">if</span> (mit-&gt;second.lastReply - simTime() &gt; idStoreTime) {
            <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>.erase(mit);
        }
    }

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a68253a9f1958b785eeb228fba30b1a18"></a><!-- doxytag: member="I3BaseApp::removeTrigger" ref="a68253a9f1958b785eeb228fba30b1a18" args="(const I3Trigger &amp;trigger)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::removeTrigger </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classI3Trigger.html">I3Trigger</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>trigger</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes a trigger from <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>trigger</em>&nbsp;</td><td>Trigger to be removed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00462">462</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3RemoveTriggerMessage.html">I3RemoveTriggerMessage</a> *msg = <span class="keyword">new</span> <a class="code" href="classI3RemoveTriggerMessage.html">I3RemoveTriggerMessage</a>();
    msg-&gt;<a class="code" href="classI3RemoveTriggerMessage__Base.html#adb2a24646e76bfeb13dc48ab4aba5ca0">setTrigger</a>(t);
    msg-&gt;setBitLength(<a class="code" href="I3Message__m_8h.html#aa3d907610b9bf82ececd116606b08990">REMOVE_TRIGGER_L</a>(msg));
    <a class="code" href="classI3BaseApp.html#a08b3797a36f5db7aa40570dd71be46fc" title="Sends a message through UDP.">sendThroughUDP</a>(msg, <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a918f76ec19bb88c76f717c704ef5180e">address</a>);

    <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.erase(t);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af3b756630dc30bc55e152699da9346f5"></a><!-- doxytag: member="I3BaseApp::removeTrigger" ref="af3b756630dc30bc55e152699da9346f5" args="(const I3Identifier &amp;identifier)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::removeTrigger </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>identifier</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes all triggers from the list of inserted triggers whose identifiers equal the one given. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>identifier</em>&nbsp;</td><td>Identifier to be compared against </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00449">449</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3Session_8cc_source.html#l00125">I3SessionClient::deliver()</a>, and <a class="el" href="I3Session_8cc_source.html#l00188">I3SessionClient::handleTimerEvent()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3Trigger.html" title="Implementation of an Internet Indirection Infrastructure trigger.">I3Trigger</a> dummy;
    dummy.<a class="code" href="classI3Trigger.html#a725ac2b3320c84d6b22d3afec2b50870" title="Sets the identifier.">setIdentifier</a>(identifier);

    set&lt;I3Trigger&gt;::iterator it = <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.lower_bound(dummy);
    <span class="keywordflow">if</span> (it == <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.end()) <span class="keywordflow">return</span>; <span class="comment">/* no matches */</span>

    <span class="keywordflow">for</span> (; it != <a class="code" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11" title="Stored I3 triggers sent from this node, to be refreshed automatically.">insertedTriggers</a>.end() &amp;&amp; it-&gt;getIdentifier() == identifier; it++) {
        <a class="code" href="classI3BaseApp.html#af3b756630dc30bc55e152699da9346f5" title="Removes all triggers from the list of inserted triggers whose identifiers equal the one given...">removeTrigger</a>(*it);
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1af4d14d796637874b72c14a49549958"></a><!-- doxytag: member="I3BaseApp::retrieveClosestIdentifier" ref="a1af4d14d796637874b72c14a49549958" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classI3Identifier.html">I3Identifier</a> I3BaseApp::retrieveClosestIdentifier </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00344">344</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3HostMobility_8cc_source.html#l00133">I3HostMobility::handleTimerEvent()</a>, <a class="el" href="I3LatencyStretch_8cc_source.html#l00135">I3LatencyStretch::initializeI3()</a>, and <a class="el" href="I3HostMobility_8cc_source.html#l00078">I3HostMobility::initializeI3()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    simtime_t time;
    <a class="code" href="classI3Identifier.html">I3Identifier</a> id;
    map&lt;I3Identifier, I3CachedServer&gt;::iterator mit;
    <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a> myAddress(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>, par(<span class="stringliteral">&quot;clientPort&quot;</span>));

    time = MAXTIME;
    <span class="keywordflow">for</span> (mit = <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.begin(); mit != <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.end(); mit++) {
        <span class="keywordflow">if</span> (time &gt; mit-&gt;second.roundTripTime) {
            time = mit-&gt;second.roundTripTime;
            <span class="keywordtype">id</span> = mit-&gt;first;
        }
    }
    <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>.erase(<span class="keywordtype">id</span>);

    <a class="code" href="classI3Identifier.html">I3Identifier</a> rid;
    rid.<a class="code" href="classI3Identifier.html#ab5db17a7b6f5e1439f77da2776d2d180">createRandomKey</a>();

    ostringstream os;
    os &lt;&lt; myAddress &lt;&lt; <span class="stringliteral">&quot; sample&quot;</span>;
    rid.<a class="code" href="classI3Identifier.html#ac0f3d9132f29a83269ecb3842356d6e2">setName</a>(os.str());

    <a class="code" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">samplingCache</a>[rid] = I3CachedServer(); <span class="comment">// placeholder</span>
    <a class="code" href="classI3BaseApp.html#a23337061eee9bd1792b3068894a992b6" title="Inserts a trigger into I3, composed by the given identifier and an identifier stack containing only t...">insertTrigger</a>(rid, <span class="keyword">false</span>);

    <span class="keywordflow">return</span> id;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af4e31dfccf3dc75dd7a8b409ffa31a7a"></a><!-- doxytag: member="I3BaseApp::sendPacket" ref="af4e31dfccf3dc75dd7a8b409ffa31a7a" args="(const I3IdentifierStack &amp;stack, cPacket *msg, bool useHint=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::sendPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classI3IdentifierStack.html">I3IdentifierStack</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>stack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPacket *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>useHint</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Routes a packet through <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stack</em>&nbsp;</td><td>Destination identifier stack </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Message to be sent </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>useHint</em>&nbsp;</td><td>Use address in server cache if existant </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00381">381</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3SendPacketMessage.html">I3SendPacketMessage</a> *smsg;

    smsg = <span class="keyword">new</span> <a class="code" href="classI3SendPacketMessage.html">I3SendPacketMessage</a>();
    smsg-&gt;setBitLength(<a class="code" href="I3Message__m_8h.html#ae7fce2ecc74dbf0da3e01ffa4b7b4830">SEND_PACKET_L</a>(smsg));
    smsg-&gt;encapsulate(msg);
    smsg-&gt;<a class="code" href="classI3SendPacketMessage__Base.html#ae7240aa53907fdd86e41bb17d1a1e081">setIdentifierStack</a>(stack);

    smsg-&gt;<a class="code" href="classI3SendPacketMessage__Base.html#a8ca0b351ab33b3efa421b0a4c6fbfbbc">setSendReply</a>(useHint);
    <span class="keywordflow">if</span> (useHint) {
        <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a> add(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>, par(<span class="stringliteral">&quot;clientPort&quot;</span>));
        smsg-&gt;<a class="code" href="classI3SendPacketMessage__Base.html#afadb7c7ffd60dfeec603cba2722fda7c">setSource</a>(add);
    }

    <a class="code" href="classI3BaseApp.html#aced3b8b7fdc0d78e1a4c1aabd066b02e" title="Number of sent messages.">numSent</a>++;
    <a class="code" href="classI3BaseApp.html#ac43cfddcbde6776668307bb00f1d19be">sentBytes</a> += smsg-&gt;getByteLength();

    <a class="code" href="classI3SubIdentifier.html" title="A wrapper around either an I3IPAddress or an I3Identifier.">I3SubIdentifier</a> subid = stack.<a class="code" href="classI3IdentifierStack.html#a4cac49ae77f9d10a09e78502a741c830" title="Returns a reference to the top of the stack.">peek</a>(); <span class="comment">// first check where the packet should go</span>
    <span class="keywordflow">if</span> (subid.<a class="code" href="classI3SubIdentifier.html#a8e2b2f6354e24556ac78e91e5e467510" title="Returns the subidentifier type.">getType</a>() == I3SubIdentifier::IPAddress) { <span class="comment">// if it&#39;s an IP address</span>
        smsg-&gt;<a class="code" href="classI3SendPacketMessage__Base.html#af0180ec364a7d5c110d62419e1f615b8">getIdentifierStack</a>().<a class="code" href="classI3IdentifierStack.html#a94c6bc20992b854ee53cbf9b1e20aae0" title="Pops a subidentifier from the top of the stack.">pop</a>(); <span class="comment">// pop it</span>
        <a class="code" href="classI3BaseApp.html#a08b3797a36f5db7aa40570dd71be46fc" title="Sends a message through UDP.">sendThroughUDP</a>(smsg, subid.<a class="code" href="classI3SubIdentifier.html#aca40c15817a73d7854b1a3d395eb1ee5" title="Returns the IP address.">getIPAddress</a>()); <span class="comment">// and send directly to host</span>
    } <span class="keywordflow">else</span> { <span class="comment">// else if it&#39;s an identifier</span>
        <span class="comment">// check if we have the I3 server cached</span>
        <a class="code" href="structI3IPAddress.html" title="A simple wrapper around an IPvXAddress and a port.">I3IPAddress</a> address = (useHint &amp;&amp; <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>.count(subid.<a class="code" href="classI3SubIdentifier.html#a4250f1068693c6e25be429d7417233a6" title="Returns the identifier.">getIdentifier</a>()) != 0) ?
                              <a class="code" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">identifierCache</a>[subid.<a class="code" href="classI3SubIdentifier.html#a4250f1068693c6e25be429d7417233a6" title="Returns the identifier.">getIdentifier</a>()].address :
                              <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a918f76ec19bb88c76f717c704ef5180e">address</a>;
        <a class="code" href="classI3BaseApp.html#a08b3797a36f5db7aa40570dd71be46fc" title="Sends a message through UDP.">sendThroughUDP</a>(smsg, address); <span class="comment">// send it directly</span>
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a68053b095070058352215964c5ad375e"></a><!-- doxytag: member="I3BaseApp::sendPacket" ref="a68053b095070058352215964c5ad375e" args="(const I3Identifier &amp;id, cPacket *msg, bool useHint=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::sendPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classI3Identifier.html">I3Identifier</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPacket *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>useHint</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Routes a packet through <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>, passing an identifier stack composed of a single identifier. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>Destination identifier </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Message to be sent </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>useHint</em>&nbsp;</td><td>Use address in server cache if existant </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00373">373</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3Composite_8cc_source.html#l00080">I3Composite::createMessage()</a>, <a class="el" href="I3Triggers_8cc_source.html#l00117">I3Triggers::deliver()</a>, <a class="el" href="I3Session_8cc_source.html#l00125">I3SessionClient::deliver()</a>, <a class="el" href="I3Session_8cc_source.html#l00067">I3SessionServer::deliver()</a>, <a class="el" href="I3LatencyStretch_8cc_source.html#l00172">I3LatencyStretch::deliver()</a>, <a class="el" href="I3HostMobility_8cc_source.html#l00102">I3HostMobility::deliver()</a>, <a class="el" href="I3Composite_8cc_source.html#l00110">I3Composite::deliver()</a>, <a class="el" href="I3Anycast_8cc_source.html#l00081">I3Anycast::deliver()</a>, <a class="el" href="I3HostMobility_8cc_source.html#l00174">I3HostMobility::discoverPartners()</a>, <a class="el" href="I3Triggers_8cc_source.html#l00087">I3Triggers::handleTimerEvent()</a>, <a class="el" href="I3Session_8cc_source.html#l00188">I3SessionClient::handleTimerEvent()</a>, <a class="el" href="I3Multicast_8cc_source.html#l00064">I3Multicast::handleTimerEvent()</a>, <a class="el" href="I3LatencyStretch_8cc_source.html#l00226">I3LatencyStretch::handleTimerEvent()</a>, <a class="el" href="I3HostMobility_8cc_source.html#l00133">I3HostMobility::handleTimerEvent()</a>, <a class="el" href="I3Anycast_8cc_source.html#l00066">I3Anycast::handleTimerEvent()</a>, and <a class="el" href="I3Session_8cc_source.html#l00246">I3SessionClientStarter::initializeI3()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3IdentifierStack.html" title="Stack of I3SubIdentifier, implementing the &amp;quot;identifier stack&amp;quot; proposed in Internet Indirect...">I3IdentifierStack</a> stack;

    stack.<a class="code" href="classI3IdentifierStack.html#aea6b94c0f8f1c52e5ea5a16f31927655" title="Pushes an I3Identifier.">push</a>(<span class="keywordtype">id</span>);
    <a class="code" href="classI3BaseApp.html#a68053b095070058352215964c5ad375e" title="Routes a packet through I3, passing an identifier stack composed of a single identifier.">sendPacket</a>(stack, msg, useHint);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a08b3797a36f5db7aa40570dd71be46fc"></a><!-- doxytag: member="I3BaseApp::sendThroughUDP" ref="a08b3797a36f5db7aa40570dd71be46fc" args="(cMessage *msg, const I3IPAddress &amp;ip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::sendThroughUDP </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structI3IPAddress.html">I3IPAddress</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>ip</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends a message through UDP. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Message to be sent </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ip</em>&nbsp;</td><td>IP of destination </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00248">248</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p>Referenced by <a class="el" href="I3TriggerRoutingTime_8cc_source.html#l00089">I3TRTClient::handleTimerEvent()</a>, <a class="el" href="I3LatencyStretch_8cc_source.html#l00226">I3LatencyStretch::handleTimerEvent()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00431">insertTrigger()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00462">removeTrigger()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00381">sendPacket()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00243">sendToI3()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    msg-&gt;removeControlInfo();
    msg-&gt;setKind(UDP_C_DATA);

    UDPControlInfo* udpControlInfo = <span class="keyword">new</span> UDPControlInfo();
    udpControlInfo-&gt;setSrcAddr(<a class="code" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676" title="Cached IP address of this node.">nodeIPAddress</a>);
    udpControlInfo-&gt;setSrcPort(par(<span class="stringliteral">&quot;clientPort&quot;</span>));

    udpControlInfo-&gt;setDestAddr(add.getIp());
    udpControlInfo-&gt;setDestPort(add.getPort());

    msg-&gt;setControlInfo(udpControlInfo);
    send(msg, <span class="stringliteral">&quot;udpOut&quot;</span>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5ec27766a5e352a0036913dc9fe7cc18"></a><!-- doxytag: member="I3BaseApp::sendToI3" ref="a5ec27766a5e352a0036913dc9fe7cc18" args="(I3Message *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I3BaseApp::sendToI3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classI3Message.html">I3Message</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends a message to <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>Message to be sent </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="I3BaseApp_8cc_source.html#l00243">243</a> of file <a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classI3BaseApp.html#a08b3797a36f5db7aa40570dd71be46fc" title="Sends a message through UDP.">sendThroughUDP</a>(msg, <a class="code" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">gateway</a>.<a class="code" href="structI3BaseApp_1_1I3CachedServer.html#a918f76ec19bb88c76f717c704ef5180e">address</a>);
}
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a3b5dc68c38b8bcd5e9d7ce5a36dcc97e"></a><!-- doxytag: member="I3BaseApp::bootstrapTimer" ref="a3b5dc68c38b8bcd5e9d7ce5a36dcc97e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classI3BaseApp.html#a3b5dc68c38b8bcd5e9d7ce5a36dcc97e">I3BaseApp::bootstrapTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00102">102</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a57438e530a99583efeadbd2d90f90a7c"></a><!-- doxytag: member="I3BaseApp::gateway" ref="a57438e530a99583efeadbd2d90f90a7c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structI3BaseApp_1_1I3CachedServer.html">I3CachedServer</a> <a class="el" href="classI3BaseApp.html#a57438e530a99583efeadbd2d90f90a7c">I3BaseApp::gateway</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00090">90</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, <a class="el" href="I3TriggerRoutingTime_8cc_source.html#l00089">I3TRTClient::handleTimerEvent()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00431">insertTrigger()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00264">refreshTriggers()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00462">removeTrigger()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00381">sendPacket()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00243">sendToI3()</a>.</p>

</div>
</div>
<a class="anchor" id="ad96479e30855ce52cb846803d03967bf"></a><!-- doxytag: member="I3BaseApp::identifierCache" ref="ad96479e30855ce52cb846803d03967bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classI3Identifier.html">I3Identifier</a>, <a class="el" href="structI3BaseApp_1_1I3CachedServer.html">I3CachedServer</a>&gt; <a class="el" href="classI3BaseApp.html#ad96479e30855ce52cb846803d03967bf">I3BaseApp::identifierCache</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00088">88</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00199">handleUDPMessage()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00264">refreshTriggers()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00381">sendPacket()</a>.</p>

</div>
</div>
<a class="anchor" id="af3504810336d23fa3d2bbbd86efa07ce"></a><!-- doxytag: member="I3BaseApp::initializeTimer" ref="af3504810336d23fa3d2bbbd86efa07ce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classI3BaseApp.html#af3504810336d23fa3d2bbbd86efa07ce">I3BaseApp::initializeTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00100">100</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a093782cbd28bcbce6c070fd582c2cd11"></a><!-- doxytag: member="I3BaseApp::insertedTriggers" ref="a093782cbd28bcbce6c070fd582c2cd11" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classI3Trigger.html">I3Trigger</a>&gt; <a class="el" href="classI3BaseApp.html#a093782cbd28bcbce6c070fd582c2cd11">I3BaseApp::insertedTriggers</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stored <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> triggers sent from this node, to be refreshed automatically. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00084">84</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00472">getInsertedTriggers()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00431">insertTrigger()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00264">refreshTriggers()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00449">removeTrigger()</a>.</p>

</div>
</div>
<a class="anchor" id="a59b897def4737a6b076139f8d7ef5fd3"></a><!-- doxytag: member="I3BaseApp::mobilityInStages" ref="a59b897def4737a6b076139f8d7ef5fd3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classI3BaseApp.html#a59b897def4737a6b076139f8d7ef5fd3">I3BaseApp::mobilityInStages</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00216">216</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="ac5f0e6bc96603ee017aaf3d681208676"></a><!-- doxytag: member="I3BaseApp::nodeIPAddress" ref="ac5f0e6bc96603ee017aaf3d681208676" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IPvXAddress <a class="el" href="classI3BaseApp.html#ac5f0e6bc96603ee017aaf3d681208676">I3BaseApp::nodeIPAddress</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cached IP address of this node. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00081">81</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, <a class="el" href="I3LatencyStretch_8cc_source.html#l00172">I3LatencyStretch::deliver()</a>, <a class="el" href="I3TriggerRoutingTime_8cc_source.html#l00089">I3TRTClient::handleTimerEvent()</a>, <a class="el" href="I3LatencyStretch_8cc_source.html#l00226">I3LatencyStretch::handleTimerEvent()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00412">insertTrigger()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00264">refreshTriggers()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00344">retrieveClosestIdentifier()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00381">sendPacket()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00248">sendThroughUDP()</a>.</p>

</div>
</div>
<a class="anchor" id="a307c1051e74b5d54e8296bddd8391be3"></a><!-- doxytag: member="I3BaseApp::numIsolations" ref="a307c1051e74b5d54e8296bddd8391be3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classI3BaseApp.html#a307c1051e74b5d54e8296bddd8391be3">I3BaseApp::numIsolations</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of times this node has been isolated - i.e. </p>
<p>without any <a class="el" href="classI3.html" title="Main Omnet module for the implementation of Internet Indirection Infrastructure.">I3</a> servers known </p>

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00078">78</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00264">refreshTriggers()</a>.</p>

</div>
</div>
<a class="anchor" id="ad358ae17066ac6f81728bb15bd04c3b7"></a><!-- doxytag: member="I3BaseApp::numReceived" ref="ad358ae17066ac6f81728bb15bd04c3b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classI3BaseApp.html#ad358ae17066ac6f81728bb15bd04c3b7">I3BaseApp::numReceived</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of received messages. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00073">73</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00199">handleUDPMessage()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="aced3b8b7fdc0d78e1a4c1aabd066b02e"></a><!-- doxytag: member="I3BaseApp::numSent" ref="aced3b8b7fdc0d78e1a4c1aabd066b02e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classI3BaseApp.html#aced3b8b7fdc0d78e1a4c1aabd066b02e">I3BaseApp::numSent</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of sent messages. </p>

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00068">68</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00381">sendPacket()</a>.</p>

</div>
</div>
<a class="anchor" id="a3bf7151c9eace249e6adb1a0ae247082"></a><!-- doxytag: member="I3BaseApp::receivedBytes" ref="a3bf7151c9eace249e6adb1a0ae247082" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classI3BaseApp.html#a3bf7151c9eace249e6adb1a0ae247082">I3BaseApp::receivedBytes</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00075">75</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00199">handleUDPMessage()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c5c6cc8192891a9c95613ff3d9095ba"></a><!-- doxytag: member="I3BaseApp::refreshSamplesTime" ref="a7c5c6cc8192891a9c95613ff3d9095ba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classI3BaseApp.html#a7c5c6cc8192891a9c95613ff3d9095ba">I3BaseApp::refreshSamplesTime</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00098">98</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8c2b57a7dcfe8c13d77dcd3956d315d"></a><!-- doxytag: member="I3BaseApp::refreshSamplesTimer" ref="aa8c2b57a7dcfe8c13d77dcd3956d315d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classI3BaseApp.html#aa8c2b57a7dcfe8c13d77dcd3956d315d">I3BaseApp::refreshSamplesTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00096">96</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

</div>
</div>
<a class="anchor" id="a41579ebabece039a0c1e8da7f6439c72"></a><!-- doxytag: member="I3BaseApp::refreshTriggersTime" ref="a41579ebabece039a0c1e8da7f6439c72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classI3BaseApp.html#a41579ebabece039a0c1e8da7f6439c72">I3BaseApp::refreshTriggersTime</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00094">94</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

</div>
</div>
<a class="anchor" id="aa765d4de34ee5931c8d86f7cfc7f4ee0"></a><!-- doxytag: member="I3BaseApp::refreshTriggersTimer" ref="aa765d4de34ee5931c8d86f7cfc7f4ee0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classI3BaseApp.html#aa765d4de34ee5931c8d86f7cfc7f4ee0">I3BaseApp::refreshTriggersTimer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00092">92</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00160">handleMessage()</a>.</p>

</div>
</div>
<a class="anchor" id="abb7a4d8356428a7fa2472061ab43a813"></a><!-- doxytag: member="I3BaseApp::samplingCache" ref="abb7a4d8356428a7fa2472061ab43a813" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classI3Identifier.html">I3Identifier</a>, <a class="el" href="structI3BaseApp_1_1I3CachedServer.html">I3CachedServer</a>&gt; <a class="el" href="classI3BaseApp.html#abb7a4d8356428a7fa2472061ab43a813">I3BaseApp::samplingCache</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00086">86</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00121">bootstrapI3()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00199">handleUDPMessage()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00332">refreshSamples()</a>, <a class="el" href="I3BaseApp_8cc_source.html#l00264">refreshTriggers()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00344">retrieveClosestIdentifier()</a>.</p>

</div>
</div>
<a class="anchor" id="ac43cfddcbde6776668307bb00f1d19be"></a><!-- doxytag: member="I3BaseApp::sentBytes" ref="ac43cfddcbde6776668307bb00f1d19be" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classI3BaseApp.html#ac43cfddcbde6776668307bb00f1d19be">I3BaseApp::sentBytes</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="I3BaseApp_8h_source.html#l00070">70</a> of file <a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a>.</p>

<p>Referenced by <a class="el" href="I3BaseApp_8cc_source.html#l00071">initialize()</a>, and <a class="el" href="I3BaseApp_8cc_source.html#l00381">sendPacket()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="I3BaseApp_8h_source.html">I3BaseApp.h</a></li>
<li><a class="el" href="I3BaseApp_8cc_source.html">I3BaseApp.cc</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Nov 3 2010 14:40:50 for OverSim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
