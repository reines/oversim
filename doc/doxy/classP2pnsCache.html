<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: P2pnsCache Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<h1>P2pnsCache Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="P2pnsCache" -->
<p>P2PNS name cache module.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="P2pnsCache_8h_source.html">P2pnsCache.h</a>&gt;</code></p>

<p><a href="classP2pnsCache-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#aab37286ced92f638c6df664c69182b78">numInitStages</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#abff0e777ab778691bb54f7d4b1a78012">initialize</a> (int stage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a3252f0dd96f23b98f2dad833e0f717fc">handleMessage</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a02b02d1795f10de902abad6846e5bcd8">getSize</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns number of stored data items in the map.  <a href="#a02b02d1795f10de902abad6846e5bcd8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a82aa4ddb3f2df3345107d4dd4bfa245c">clear</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clears all stored data items.  <a href="#a82aa4ddb3f2df3345107d4dd4bfa245c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a300d0031a524bb70d780422d5e20ea71">isEmpty</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if the data storage map is empty.  <a href="#a300d0031a524bb70d780422d5e20ea71"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classP2pnsIdCacheEntry.html">P2pnsIdCacheEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#aa9cdc445c8cf1d85665f6d60efe2fc0d">getIdCacheEntry</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classP2pnsIdCacheEntry.html">P2pnsIdCacheEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a2cfb11e6db76b3caee1f5e8467184b33">addIdCacheEntry</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key, const <a class="el" href="classBinaryValue.html">BinaryValue</a> *payload=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a8e835fe8385e0d6412045d0e401e1905">removeIdCacheEntry</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#af1b893aaaa1d336f1e5a11ca5a1285c8">getData</a> (const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the value of a stored data item with a given name.  <a href="#af1b893aaaa1d336f1e5a11ca5a1285c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a9d26692a2f95f344bb38cad775fab6f8">getTtlMessage</a> (const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the ttlMessage of a stored data item with a given name.  <a href="#a9d26692a2f95f344bb38cad775fab6f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#ae91e3c513cdd8779d0a8f721a047828a">getDataAtPos</a> (uint32_t pos=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the value of the data item stored at position pos.  <a href="#ae91e3c513cdd8779d0a8f721a047828a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a7f9e267a7050a16de64d623d22143224">addData</a> (<a class="el" href="classBinaryValue.html">BinaryValue</a> name, <a class="el" href="classBinaryValue.html">BinaryValue</a> value, cMessage *ttlMessage=NULL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store a new data item in the map.  <a href="#a7f9e267a7050a16de64d623d22143224"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a6e9fa002a2eae3518bd76873cb623a9f">removeData</a> (const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes a certain data item from the map.  <a href="#a6e9fa002a2eae3518bd76873cb623a9f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a5b6ca38a6a474a094975c23ea83cfd09">display</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a9440b69adb9751861570339ab6efb047">updateDisplayString</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the display string.  <a href="#a9440b69adb9751861570339ab6efb047"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a652faf7fc6b6ffc22356918098bf6df5">updateTooltip</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the tooltip.  <a href="#a652faf7fc6b6ffc22356918098bf6df5"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classBinaryValue.html">BinaryValue</a>, <br class="typebreak"/>
<a class="el" href="structP2pnsCacheEntry.html">P2pnsCacheEntry</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83">cache</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">internal representation of the cache  <a href="#a9f36cbcd3176203da96a36e822691b83"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="P2pnsCache_8h.html#aa3e78418bbb9e982b92516e26f1667b7">P2pnsIdCache</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0">idCache</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">internal representation of the KBR nodeId cache  <a href="#a18a58c6a3ae13986c9824ca6b4aadef0"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>P2PNS name cache module. </p>
<p>This modul contains the name cache of the P2PNS implementation.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Ingmar Baumgart </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="P2pns_8cc.html">P2pns.cc</a> </dd></dl>

<p>Definition at line <a class="el" href="P2pnsCache_8h_source.html#l00075">75</a> of file <a class="el" href="P2pnsCache_8h_source.html">P2pnsCache.h</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a7f9e267a7050a16de64d623d22143224"></a><!-- doxytag: member="P2pnsCache::addData" ref="a7f9e267a7050a16de64d623d22143224" args="(BinaryValue name, BinaryValue value, cMessage *ttlMessage=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::addData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBinaryValue.html">BinaryValue</a>&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBinaryValue.html">BinaryValue</a>&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>ttlMessage</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Store a new data item in the map. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the data item to be stored </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>The value of the data item to be stored </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ttlMessage</em>&nbsp;</td><td>The self-message sent for the ttl expiration </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00162">162</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p>Referenced by <a class="el" href="P2pns_8cc_source.html#l00384">P2pns::p2pnsRegisterRpc()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="structP2pnsCacheEntry.html">P2pnsCacheEntry</a> entry;
    entry.<a class="code" href="structP2pnsCacheEntry.html#a1f5c70c13d860555ba6f131ba35039b9">value</a> = value;
    entry.<a class="code" href="structP2pnsCacheEntry.html#a7de727347053085047633214dcbd5109">ttlMessage</a> = ttlMessage;
    <span class="comment">// replace with new value</span>
    <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.erase(name);
    <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.insert(make_pair(name, entry));
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2cfb11e6db76b3caee1f5e8467184b33"></a><!-- doxytag: member="P2pnsCache::addIdCacheEntry" ref="a2cfb11e6db76b3caee1f5e8467184b33" args="(const OverlayKey &amp;key, const BinaryValue *payload=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classP2pnsIdCacheEntry.html">P2pnsIdCacheEntry</a> * P2pnsCache::addIdCacheEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBinaryValue.html">BinaryValue</a> *&nbsp;</td>
          <td class="paramname"> <em>payload</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00101">101</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p>Referenced by <a class="el" href="P2pns_8cc_source.html#l00071">P2pns::tunnel()</a>, and <a class="el" href="P2pns_8cc_source.html#l00269">P2pns::updateIdCacheWithNewTransport()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    P2pnsIdCache::iterator it = <a class="code" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0" title="internal representation of the KBR nodeId cache">idCache</a>.find(key);

    <span class="keywordflow">if</span> (it == <a class="code" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0" title="internal representation of the KBR nodeId cache">idCache</a>.end()) {
        it = <a class="code" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0" title="internal representation of the KBR nodeId cache">idCache</a>.insert(make_pair(key, <a class="code" href="classP2pnsIdCacheEntry.html">P2pnsIdCacheEntry</a>(key))).first;
    }

    <span class="keywordflow">if</span> (payload != NULL) {
        it-&gt;second.payloadQueue.push_back(*payload);
    }

    it-&gt;second.lastUsage = simTime();

    <span class="keywordflow">return</span> &amp;it-&gt;second;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a82aa4ddb3f2df3345107d4dd4bfa245c"></a><!-- doxytag: member="P2pnsCache::clear" ref="a82aa4ddb3f2df3345107d4dd4bfa245c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::clear </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clears all stored data items. </p>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00067">67</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
  map&lt;BinaryValue, P2pnsCacheEntry&gt;::iterator iter;
  <span class="keywordflow">for</span>( iter = <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.begin(); iter != <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.end(); iter++ ) {
    cancelAndDelete(iter-&gt;second.ttlMessage);
  }
  <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.clear();
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5b6ca38a6a474a094975c23ea83cfd09"></a><!-- doxytag: member="P2pnsCache::display" ref="a5b6ca38a6a474a094975c23ea83cfd09" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::display </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00214">214</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Content of P2pnsCache:&quot;</span> &lt;&lt; endl;
    <span class="keywordflow">for</span> (std::map&lt;BinaryValue, P2pnsCacheEntry&gt;::iterator it = <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.begin();
         it != <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.end(); it++) {
        cout &lt;&lt; <span class="stringliteral">&quot;name: &quot;</span> &lt;&lt; it-&gt;first &lt;&lt; <span class="stringliteral">&quot; Value: &quot;</span> &lt;&lt; it-&gt;second.value &lt;&lt; <span class="stringliteral">&quot;End-time: &quot;</span> &lt;&lt; it-&gt;second.ttlMessage-&gt;getArrivalTime() &lt;&lt; endl;
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af1b893aaaa1d336f1e5a11ca5a1285c8"></a><!-- doxytag: member="P2pnsCache::getData" ref="af1b893aaaa1d336f1e5a11ca5a1285c8" args="(const BinaryValue &amp;name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp; P2pnsCache::getData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the value of a stored data item with a given name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the data item </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The value of the data item with the given name </dd></dl>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00124">124</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">                                                              {

    std::map&lt;BinaryValue, P2pnsCacheEntry&gt;::iterator it =  <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.find(name);

    <span class="keywordflow">if</span> (it == <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.end())
        <span class="keywordflow">return</span> <a class="code" href="classBinaryValue.html#a895c82622c044fbc70da7c18e3ce87b9">BinaryValue::UNSPECIFIED_VALUE</a>;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> it-&gt;second.value;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae91e3c513cdd8779d0a8f721a047828a"></a><!-- doxytag: member="P2pnsCache::getDataAtPos" ref="ae91e3c513cdd8779d0a8f721a047828a" args="(uint32_t pos=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp; P2pnsCache::getDataAtPos </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>pos</em> = <code>0</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the value of the data item stored at position pos. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pos</em>&nbsp;</td><td>position in data storage map </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The value of the data item at position pos </dd></dl>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00146">146</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p>Referenced by <a class="el" href="P2pnsCache_8cc_source.html#l00196">updateTooltip()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (pos &gt;= <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.size()) {
        <a class="code" href="yang_8cc.html#adb989392f8aada21b0f7ec2f7a41dc00">error</a>(<span class="stringliteral">&quot;Index out of bound (P2pnsCache, getDataAtPos())&quot;</span>);
    }

    std::map&lt;BinaryValue, P2pnsCacheEntry&gt;::iterator it = <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.begin();
    <span class="keywordflow">for</span> (uint32_t i= 0; i &lt; pos; i++) {
        it++;
        <span class="keywordflow">if</span> (i == (pos-1))
            <span class="keywordflow">return</span> it-&gt;second.value;
    }
    <span class="keywordflow">return</span> it-&gt;second.value;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa9cdc445c8cf1d85665f6d60efe2fc0d"></a><!-- doxytag: member="P2pnsCache::getIdCacheEntry" ref="aa9cdc445c8cf1d85665f6d60efe2fc0d" args="(const OverlayKey &amp;key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classP2pnsIdCacheEntry.html">P2pnsIdCacheEntry</a> * P2pnsCache::getIdCacheEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00090">90</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p>Referenced by <a class="el" href="P2pns_8cc_source.html#l00227">P2pns::handleTimerEvent()</a>, <a class="el" href="P2pns_8cc_source.html#l00104">P2pns::handleTunnelLookupResponse()</a>, <a class="el" href="P2pns_8cc_source.html#l00205">P2pns::pingTimeout()</a>, <a class="el" href="P2pns_8cc_source.html#l00071">P2pns::tunnel()</a>, and <a class="el" href="P2pns_8cc_source.html#l00269">P2pns::updateIdCacheWithNewTransport()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    P2pnsIdCache::iterator it = <a class="code" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0" title="internal representation of the KBR nodeId cache">idCache</a>.find(key);

    <span class="keywordflow">if</span> (it != <a class="code" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0" title="internal representation of the KBR nodeId cache">idCache</a>.end()) {
        <span class="keywordflow">return</span> &amp;it-&gt;second;
    } <span class="keywordflow">else</span> {
        <span class="keywordflow">return</span> NULL;
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a02b02d1795f10de902abad6846e5bcd8"></a><!-- doxytag: member="P2pnsCache::getSize" ref="a02b02d1795f10de902abad6846e5bcd8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t P2pnsCache::getSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns number of stored data items in the map. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of stored data items </dd></dl>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00077">77</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.size();
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9d26692a2f95f344bb38cad775fab6f8"></a><!-- doxytag: member="P2pnsCache::getTtlMessage" ref="a9d26692a2f95f344bb38cad775fab6f8" args="(const BinaryValue &amp;name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage * P2pnsCache::getTtlMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the ttlMessage of a stored data item with a given name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the data item </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The ttlMessage of the data item with the given name </dd></dl>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00136">136</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">                                                          {
    std::map&lt;BinaryValue, P2pnsCacheEntry&gt;::iterator it = <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.find(name);

    <span class="keywordflow">if</span> (it == <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.end())
        <span class="keywordflow">return</span> NULL;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> it-&gt;second.ttlMessage;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3252f0dd96f23b98f2dad833e0f717fc"></a><!-- doxytag: member="P2pnsCache::handleMessage" ref="a3252f0dd96f23b98f2dad833e0f717fc" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00062">62</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="yang_8cc.html#adb989392f8aada21b0f7ec2f7a41dc00">error</a>(<span class="stringliteral">&quot;This module doesn&#39;t handle messages!&quot;</span>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="abff0e777ab778691bb54f7d4b1a78012"></a><!-- doxytag: member="P2pnsCache::initialize" ref="abff0e777ab778691bb54f7d4b1a78012" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::initialize </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00053">53</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (stage != <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532ad9afa81d0184c5f0649fa111f7a821bc" title="deprecated">MIN_STAGE_APP</a>)
        <span class="keywordflow">return</span>;

    WATCH_MAP(<a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>);
    WATCH_MAP(<a class="code" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0" title="internal representation of the KBR nodeId cache">idCache</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a300d0031a524bb70d780422d5e20ea71"></a><!-- doxytag: member="P2pnsCache::isEmpty" ref="a300d0031a524bb70d780422d5e20ea71" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool P2pnsCache::isEmpty </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checks if the data storage map is empty. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns false if there are stored data items, true otherwise. </dd></dl>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00082">82</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (<a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.size() == 0)
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aab37286ced92f638c6df664c69182b78"></a><!-- doxytag: member="P2pnsCache::numInitStages" ref="aab37286ced92f638c6df664c69182b78" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int P2pnsCache::numInitStages </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="P2pnsCache_8h_source.html#l00078">78</a> of file <a class="el" href="P2pnsCache_8h_source.html">P2pnsCache.h</a>.</p>

<p><div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">return</span> MAX_STAGE_APP;
    }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6e9fa002a2eae3518bd76873cb623a9f"></a><!-- doxytag: member="P2pnsCache::removeData" ref="a6e9fa002a2eae3518bd76873cb623a9f" args="(const BinaryValue &amp;name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::removeData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBinaryValue.html">BinaryValue</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes a certain data item from the map. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the data item to be removed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00172">172</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.erase(name);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e835fe8385e0d6412045d0e401e1905"></a><!-- doxytag: member="P2pnsCache::removeIdCacheEntry" ref="a8e835fe8385e0d6412045d0e401e1905" args="(const OverlayKey &amp;key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::removeIdCacheEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00119">119</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p>Referenced by <a class="el" href="P2pns_8cc_source.html#l00227">P2pns::handleTimerEvent()</a>, <a class="el" href="P2pns_8cc_source.html#l00104">P2pns::handleTunnelLookupResponse()</a>, and <a class="el" href="P2pns_8cc_source.html#l00205">P2pns::pingTimeout()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0" title="internal representation of the KBR nodeId cache">idCache</a>.erase(key);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9440b69adb9751861570339ab6efb047"></a><!-- doxytag: member="P2pnsCache::updateDisplayString" ref="a9440b69adb9751861570339ab6efb047" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::updateDisplayString </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates the display string. </p>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00177">177</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
<span class="comment">// FIXME: doesn&#39;t work without tcl/tk</span>
    <span class="comment">//if (ev.isGUI()) {</span>
    <span class="keywordflow">if</span> (1) {
        <span class="keywordtype">char</span> buf[80];

        <span class="keywordflow">if</span> (<a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.size() == 1) {
            sprintf(buf, <span class="stringliteral">&quot;1 data item&quot;</span>);
        } <span class="keywordflow">else</span> {
            sprintf(buf, <span class="stringliteral">&quot;%zi data items&quot;</span>, <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.size());
        }

        getDisplayString().setTagArg(<span class="stringliteral">&quot;t&quot;</span>, 0, buf);
        getDisplayString().setTagArg(<span class="stringliteral">&quot;t&quot;</span>, 2, <span class="stringliteral">&quot;blue&quot;</span>);
    }

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a652faf7fc6b6ffc22356918098bf6df5"></a><!-- doxytag: member="P2pnsCache::updateTooltip" ref="a652faf7fc6b6ffc22356918098bf6df5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void P2pnsCache::updateTooltip </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates the tooltip. </p>

<p>Definition at line <a class="el" href="P2pnsCache_8cc_source.html#l00196">196</a> of file <a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (ev.isGUI()) {
        std::stringstream str;
        <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.size(); i++)     {
            str &lt;&lt; <a class="code" href="classP2pnsCache.html#ae91e3c513cdd8779d0a8f721a047828a" title="Returns the value of the data item stored at position pos.">getDataAtPos</a>(i);

            <span class="keywordflow">if</span> ( i != <a class="code" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83" title="internal representation of the cache">cache</a>.size() - 1 )
                str &lt;&lt; endl;
        }


        <span class="keywordtype">char</span> buf[1024];
        sprintf(buf, <span class="stringliteral">&quot;%s&quot;</span>, str.str().c_str());
        getDisplayString().setTagArg(<span class="stringliteral">&quot;tt&quot;</span>, 0, buf);
    }
}
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a9f36cbcd3176203da96a36e822691b83"></a><!-- doxytag: member="P2pnsCache::cache" ref="a9f36cbcd3176203da96a36e822691b83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classBinaryValue.html">BinaryValue</a>, <a class="el" href="structP2pnsCacheEntry.html">P2pnsCacheEntry</a>&gt; <a class="el" href="classP2pnsCache.html#a9f36cbcd3176203da96a36e822691b83">P2pnsCache::cache</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>internal representation of the cache </p>

<p>Definition at line <a class="el" href="P2pnsCache_8h_source.html#l00155">155</a> of file <a class="el" href="P2pnsCache_8h_source.html">P2pnsCache.h</a>.</p>

<p>Referenced by <a class="el" href="P2pnsCache_8cc_source.html#l00162">addData()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00067">clear()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00214">display()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00124">getData()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00146">getDataAtPos()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00077">getSize()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00136">getTtlMessage()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00053">initialize()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00082">isEmpty()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00172">removeData()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00177">updateDisplayString()</a>, and <a class="el" href="P2pnsCache_8cc_source.html#l00196">updateTooltip()</a>.</p>

</div>
</div>
<a class="anchor" id="a18a58c6a3ae13986c9824ca6b4aadef0"></a><!-- doxytag: member="P2pnsCache::idCache" ref="a18a58c6a3ae13986c9824ca6b4aadef0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="P2pnsCache_8h.html#aa3e78418bbb9e982b92516e26f1667b7">P2pnsIdCache</a> <a class="el" href="classP2pnsCache.html#a18a58c6a3ae13986c9824ca6b4aadef0">P2pnsCache::idCache</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>internal representation of the KBR nodeId cache </p>

<p>Definition at line <a class="el" href="P2pnsCache_8h_source.html#l00156">156</a> of file <a class="el" href="P2pnsCache_8h_source.html">P2pnsCache.h</a>.</p>

<p>Referenced by <a class="el" href="P2pnsCache_8cc_source.html#l00101">addIdCacheEntry()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00090">getIdCacheEntry()</a>, <a class="el" href="P2pnsCache_8cc_source.html#l00053">initialize()</a>, and <a class="el" href="P2pnsCache_8cc_source.html#l00119">removeIdCacheEntry()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="P2pnsCache_8h_source.html">P2pnsCache.h</a></li>
<li><a class="el" href="P2pnsCache_8cc_source.html">P2pnsCache.cc</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Nov 3 2010 14:40:52 for OverSim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
